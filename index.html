<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Voice Match - Find Your Karaoke Song</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, Oxygen, Ubuntu, sans-serif;
            min-height: 100vh;
            background: linear-gradient(135deg, #4c1d95 0%, #312e81 50%, #0f0f23 100%);
            color: white;
            padding: 16px;
        }
        
        .container {
            max-width: 500px;
            margin: 0 auto;
        }
        
        .header {
            text-align: center;
            margin-bottom: 24px;
            padding-top: 12px;
        }
        
        .header h1 {
            font-size: 28px;
            font-weight: bold;
            background: linear-gradient(90deg, #f472b6, #a78bfa, #818cf8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
            margin-bottom: 4px;
        }
        
        .header p {
            color: #c4b5fd;
            font-size: 14px;
        }
        
        .card {
            background: rgba(255, 255, 255, 0.1);
            backdrop-filter: blur(10px);
            border-radius: 16px;
            padding: 20px;
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
        }
        
        .error-box {
            background: rgba(239, 68, 68, 0.2);
            border: 1px solid #f87171;
            border-radius: 8px;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        .error-box p {
            color: #fecaca;
            margin-bottom: 8px;
        }
        
        .error-box a {
            color: #fca5a5;
            font-size: 14px;
        }
        
        .visualizer {
            height: 80px;
            display: flex;
            align-items: flex-end;
            justify-content: center;
            gap: 3px;
            margin-bottom: 16px;
        }
        
        .visualizer-bar {
            width: 8px;
            background: linear-gradient(to top, #ec4899, #a78bfa);
            border-radius: 4px 4px 0 0;
            transition: height 0.05s ease;
            min-height: 4px;
        }
        
        .timer {
            font-size: 28px;
            font-family: monospace;
            color: #c4b5fd;
            text-align: center;
            margin-bottom: 12px;
        }
        
        .instructions {
            text-align: center;
            margin-bottom: 16px;
        }
        
        .instructions p {
            color: #e9d5ff;
            margin-bottom: 4px;
        }
        
        .instructions .hint {
            font-size: 13px;
            color: #a78bfa;
        }
        
        .status {
            text-align: center;
            margin-bottom: 16px;
        }
        
        .status .listening {
            color: #86efac;
            animation: pulse 1.5s infinite;
        }
        
        .status .samples {
            font-size: 13px;
            color: #a78bfa;
            margin-top: 4px;
        }
        
        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.5; }
        }
        
        .record-btn {
            display: block;
            width: 88px;
            height: 88px;
            margin: 0 auto 12px;
            border-radius: 50%;
            border: none;
            font-size: 32px;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
        }
        
        .record-btn:active {
            transform: scale(0.95);
        }
        
        .record-btn.ready {
            background: linear-gradient(135deg, #ec4899, #8b5cf6);
        }
        
        .record-btn.recording {
            background: #ef4444;
            animation: pulse 1s infinite;
        }
        
        .record-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .btn-hint {
            text-align: center;
            font-size: 13px;
            color: #a78bfa;
        }
        
        .analyzing {
            text-align: center;
            padding: 40px 0;
        }
        
        .analyzing .spinner {
            font-size: 48px;
            animation: spin 1s linear infinite;
            margin-bottom: 12px;
        }
        
        @keyframes spin {
            from { transform: rotate(0deg); }
            to { transform: rotate(360deg); }
        }
        
        .analyzing p {
            font-size: 18px;
            color: #c4b5fd;
        }
        
        .results {
            display: none;
        }
        
        .results.show {
            display: block;
        }
        
        .profile {
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
            padding: 16px;
            margin-bottom: 16px;
        }
        
        .profile h2 {
            font-size: 16px;
            color: #c4b5fd;
            margin-bottom: 12px;
        }
        
        .profile-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 12px;
        }
        
        .profile-item label {
            display: block;
            font-size: 12px;
            color: #a78bfa;
            margin-bottom: 2px;
        }
        
        .profile-item .value {
            font-size: 16px;
            font-weight: 600;
        }
        
        .assessment {
            margin-top: 12px;
            padding: 10px;
            background: rgba(139, 92, 246, 0.2);
            border-radius: 8px;
            font-size: 14px;
        }
        
        .headline {
            font-size: 16px;
            color: #fbbf24;
            margin-bottom: 16px;
            padding: 12px;
            background: rgba(251, 191, 36, 0.1);
            border-radius: 8px;
            text-align: center;
            border: 1px solid rgba(251, 191, 36, 0.3);
        }
        
        .suck-meter-container {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 16px;
            padding: 20px;
            margin-bottom: 16px;
            border: 2px solid rgba(255, 255, 255, 0.1);
            text-align: center;
        }
        
        .suck-meter-header {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-bottom: 8px;
        }
        
        .suck-meter-title {
            font-size: 12px;
            font-weight: 700;
            letter-spacing: 3px;
            color: #a78bfa;
            text-transform: uppercase;
        }
        
        .suck-meter-emoji {
            font-size: 24px;
        }
        
        .suck-score-display {
            margin: 8px 0;
        }
        
        .suck-score {
            font-size: 72px;
            font-weight: 800;
            line-height: 1;
            text-shadow: 0 4px 20px rgba(0, 0, 0, 0.5);
        }
        
        .suck-max {
            font-size: 24px;
            color: #6b7280;
            font-weight: 400;
        }
        
        .suck-label {
            font-size: 20px;
            font-weight: 700;
            margin-bottom: 16px;
            text-transform: uppercase;
            letter-spacing: 1px;
        }
        
        .suck-meter-track {
            position: relative;
            height: 12px;
            border-radius: 6px;
            overflow: visible;
            margin: 0 10px;
        }
        
        .suck-meter-gradient {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, 
                #4ade80 0%, 
                #a3e635 15%, 
                #facc15 30%, 
                #fb923c 45%, 
                #f97316 60%, 
                #ef4444 75%, 
                #dc2626 90%, 
                #be123c 100%
            );
            border-radius: 6px;
        }
        
        .suck-meter-needle {
            position: absolute;
            top: -6px;
            width: 4px;
            height: 24px;
            background: white;
            border-radius: 2px;
            transform: translateX(-50%);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.4);
            transition: left 0.5s ease-out;
        }
        
        .suck-meter-needle::before {
            content: '';
            position: absolute;
            top: -8px;
            left: 50%;
            transform: translateX(-50%);
            width: 0;
            height: 0;
            border-left: 6px solid transparent;
            border-right: 6px solid transparent;
            border-top: 8px solid white;
        }
        
        .suck-meter-labels {
            display: flex;
            justify-content: space-between;
            margin-top: 8px;
            font-size: 10px;
            color: #9ca3af;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }
        
        .suck-description {
            margin-top: 16px;
            padding: 12px 16px;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 8px;
            font-size: 14px;
            color: #e9d5ff;
            font-style: italic;
            line-height: 1.5;
        }
        
        .metrics-bars {
            margin-top: 16px;
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        
        .metric-bar {
            width: 100%;
        }
        
        .metric-label {
            display: flex;
            justify-content: space-between;
            font-size: 12px;
            color: #c4b5fd;
            margin-bottom: 4px;
        }
        
        .metric-track {
            height: 8px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 4px;
            overflow: hidden;
        }
        
        .metric-fill {
            height: 100%;
            border-radius: 4px;
            transition: width 0.5s ease;
        }
        
        .metric-fill.stability {
            background: linear-gradient(90deg, #ef4444, #facc15, #4ade80);
        }
        
        .metric-fill.consistency {
            background: linear-gradient(90deg, #f472b6, #a78bfa);
        }
        
        .metric-fill.breath {
            background: linear-gradient(90deg, #38bdf8, #818cf8);
        }
        
        .metric-fill.vibrato {
            background: linear-gradient(90deg, #fbbf24, #f97316);
        }
        
        .feedback-section {
            margin-bottom: 16px;
        }
        
        .feedback-section h3 {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 10px;
            color: #e9d5ff;
        }
        
        .feedback-section.tips {
            background: rgba(74, 222, 128, 0.1);
            border-radius: 12px;
            padding: 14px;
            border: 1px solid rgba(74, 222, 128, 0.2);
        }
        
        .feedback-section.secrets {
            background: rgba(139, 92, 246, 0.15);
            border-radius: 12px;
            padding: 14px;
            border: 1px solid rgba(139, 92, 246, 0.3);
        }
        
        .tip-item, .secret-item {
            font-size: 13px;
            line-height: 1.5;
            padding: 8px 0;
            border-bottom: 1px solid rgba(255, 255, 255, 0.1);
        }
        
        .tip-item:last-child, .secret-item:last-child {
            border-bottom: none;
            padding-bottom: 0;
        }
        
        .tip-item:first-child, .secret-item:first-child {
            padding-top: 0;
        }
        
        .song-section.stretch .song-card { 
            background: rgba(249, 115, 22, 0.15); 
        }
        
        .song-section {
            margin-bottom: 16px;
        }
        
        .song-section h3 {
            font-size: 15px;
            font-weight: 600;
            margin-bottom: 8px;
        }
        
        .song-section.perfect h3 { color: #4ade80; }
        .song-section.good h3 { color: #facc15; }
        .song-section.stretch h3 { color: #f97316; }
        .song-section.crowd h3 { color: #f472b6; }
        
        .section-subtitle {
            font-size: 12px;
            color: #a78bfa;
            margin: -4px 0 10px 0;
        }
        
        .song-card {
            padding: 12px;
            border-radius: 8px;
            margin-bottom: 8px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .song-section.perfect .song-card { background: rgba(74, 222, 128, 0.15); }
        .song-section.good .song-card { background: rgba(250, 204, 21, 0.1); }
        .song-section.crowd .song-card { background: rgba(244, 114, 182, 0.1); }
        
        .song-info .title {
            font-weight: 600;
            margin-bottom: 2px;
        }
        
        .song-info .artist {
            font-size: 13px;
            color: #c4b5fd;
        }
        
        .difficulty {
            font-size: 11px;
            padding: 4px 8px;
            border-radius: 4px;
            font-weight: 500;
        }
        
        .difficulty.easy { background: #16a34a; }
        .difficulty.medium { background: #ca8a04; }
        .difficulty.hard { background: #dc2626; }
        
        .reset-btn {
            width: 100%;
            padding: 14px;
            background: linear-gradient(135deg, #ec4899, #8b5cf6);
            border: none;
            border-radius: 8px;
            color: white;
            font-size: 16px;
            font-weight: 600;
            cursor: pointer;
        }
        
        .reset-btn:active {
            transform: scale(0.98);
        }
        
        .footer {
            text-align: center;
            margin-top: 20px;
            font-size: 11px;
            color: #7c3aed;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>üé§ Voice Match</h1>
            <p>Find your perfect karaoke song</p>
        </div>
        
        <div class="card">
            <div id="error-container"></div>
            
            <div id="record-section">
                <div class="visualizer" id="visualizer"></div>
                
                <div class="timer" id="timer" style="display: none;">0:00</div>
                
                <div class="instructions" id="instructions">
                    <p>Press record and sing for 10-15 seconds</p>
                    <p class="hint">Sing scales, a song, or "la la la" across your range</p>
                </div>
                
                <div class="status" id="status" style="display: none;">
                    <p class="listening">üéôÔ∏è Listening... Keep singing!</p>
                    <p class="samples" id="sample-count">0 samples</p>
                </div>
                
                <button class="record-btn ready" id="record-btn">üé§</button>
                <p class="btn-hint" id="btn-hint">Tap to start</p>
            </div>
            
            <div class="analyzing" id="analyzing" style="display: none;">
                <div class="spinner">üéµ</div>
                <p>Analyzing your voice...</p>
            </div>
            
            <div class="results" id="results"></div>
        </div>
        
        <p class="footer">Voice Match ‚Ä¢ Built for karaoke lovers</p>
    </div>

    <script>
        // Song database - Comprehensive karaoke collection
        // MIDI Note Reference: C2=36, C3=48, C4=60 (middle C), C5=72, A4=69
        const SONG_DATABASE = [
            // ========== BASS/BARITONE (Low Male) - minNote: 36-45 ==========
            { title: "Ring of Fire", artist: "Johnny Cash", minNote: 38, maxNote: 50, difficulty: "easy", genre: "country" },
            { title: "Folsom Prison Blues", artist: "Johnny Cash", minNote: 36, maxNote: 48, difficulty: "easy", genre: "country" },
            { title: "Hurt", artist: "Johnny Cash", minNote: 40, maxNote: 52, difficulty: "easy", genre: "country" },
            { title: "I Walk the Line", artist: "Johnny Cash", minNote: 38, maxNote: 50, difficulty: "easy", genre: "country" },
            { title: "Man in Black", artist: "Johnny Cash", minNote: 38, maxNote: 48, difficulty: "easy", genre: "country" },
            { title: "Friends in Low Places", artist: "Garth Brooks", minNote: 38, maxNote: 52, difficulty: "easy", genre: "country" },
            { title: "The Dance", artist: "Garth Brooks", minNote: 40, maxNote: 55, difficulty: "easy", genre: "country" },
            { title: "Mammas Don't Let Your Babies Grow Up to Be Cowboys", artist: "Waylon Jennings", minNote: 38, maxNote: 50, difficulty: "easy", genre: "country" },
            { title: "On the Road Again", artist: "Willie Nelson", minNote: 40, maxNote: 52, difficulty: "easy", genre: "country" },
            { title: "Blue Eyes Crying in the Rain", artist: "Willie Nelson", minNote: 38, maxNote: 50, difficulty: "easy", genre: "country" },
            { title: "Sixteen Tons", artist: "Tennessee Ernie Ford", minNote: 36, maxNote: 48, difficulty: "easy", genre: "classic" },
            { title: "Old Man River", artist: "Paul Robeson", minNote: 34, maxNote: 48, difficulty: "medium", genre: "classic" },
            { title: "Can't Help Falling in Love", artist: "Elvis Presley", minNote: 41, maxNote: 53, difficulty: "easy", genre: "classic" },
            { title: "In the Ghetto", artist: "Elvis Presley", minNote: 40, maxNote: 52, difficulty: "easy", genre: "classic" },
            { title: "Suspicious Minds", artist: "Elvis Presley", minNote: 43, maxNote: 55, difficulty: "medium", genre: "classic" },
            { title: "Blue Suede Shoes", artist: "Elvis Presley", minNote: 43, maxNote: 55, difficulty: "easy", genre: "rock" },
            { title: "Hound Dog", artist: "Elvis Presley", minNote: 43, maxNote: 55, difficulty: "easy", genre: "rock" },
            { title: "The Gambler", artist: "Kenny Rogers", minNote: 40, maxNote: 52, difficulty: "easy", genre: "country" },
            { title: "Coward of the County", artist: "Kenny Rogers", minNote: 41, maxNote: 53, difficulty: "easy", genre: "country" },
            { title: "Tennessee Whiskey", artist: "Chris Stapleton", minNote: 40, maxNote: 55, difficulty: "medium", genre: "country" },
            { title: "Chattahoochee", artist: "Alan Jackson", minNote: 43, maxNote: 55, difficulty: "easy", genre: "country" },
            { title: "Drive", artist: "Alan Jackson", minNote: 40, maxNote: 52, difficulty: "easy", genre: "country" },
            
            // ========== BARITONE/TENOR (Mid Male) - minNote: 43-52 ==========
            { title: "Sweet Home Alabama", artist: "Lynyrd Skynyrd", minNote: 43, maxNote: 55, difficulty: "easy", genre: "rock" },
            { title: "Free Bird", artist: "Lynyrd Skynyrd", minNote: 45, maxNote: 60, difficulty: "medium", genre: "rock" },
            { title: "Simple Man", artist: "Lynyrd Skynyrd", minNote: 43, maxNote: 55, difficulty: "easy", genre: "rock" },
            { title: "Wagon Wheel", artist: "Darius Rucker", minNote: 43, maxNote: 57, difficulty: "easy", genre: "country" },
            { title: "Brown Eyed Girl", artist: "Van Morrison", minNote: 45, maxNote: 57, difficulty: "easy", genre: "rock" },
            { title: "Stand By Me", artist: "Ben E. King", minNote: 43, maxNote: 55, difficulty: "easy", genre: "soul" },
            { title: "House of the Rising Sun", artist: "The Animals", minNote: 40, maxNote: 55, difficulty: "medium", genre: "rock" },
            { title: "Piano Man", artist: "Billy Joel", minNote: 43, maxNote: 58, difficulty: "medium", genre: "rock" },
            { title: "Uptown Girl", artist: "Billy Joel", minNote: 48, maxNote: 60, difficulty: "medium", genre: "pop" },
            { title: "American Pie", artist: "Don McLean", minNote: 45, maxNote: 57, difficulty: "medium", genre: "rock" },
            { title: "Vincent", artist: "Don McLean", minNote: 45, maxNote: 57, difficulty: "easy", genre: "folk" },
            { title: "Sweet Caroline", artist: "Neil Diamond", minNote: 45, maxNote: 60, difficulty: "easy", genre: "pop" },
            { title: "Cracklin' Rosie", artist: "Neil Diamond", minNote: 45, maxNote: 58, difficulty: "easy", genre: "pop" },
            { title: "Take Me Home, Country Roads", artist: "John Denver", minNote: 47, maxNote: 60, difficulty: "easy", genre: "country" },
            { title: "Leaving on a Jet Plane", artist: "John Denver", minNote: 45, maxNote: 57, difficulty: "easy", genre: "folk" },
            { title: "Rocky Mountain High", artist: "John Denver", minNote: 45, maxNote: 60, difficulty: "easy", genre: "folk" },
            { title: "Hotel California", artist: "Eagles", minNote: 45, maxNote: 60, difficulty: "medium", genre: "rock" },
            { title: "Take It Easy", artist: "Eagles", minNote: 45, maxNote: 57, difficulty: "easy", genre: "rock" },
            { title: "Desperado", artist: "Eagles", minNote: 45, maxNote: 60, difficulty: "medium", genre: "rock" },
            { title: "Peaceful Easy Feeling", artist: "Eagles", minNote: 45, maxNote: 57, difficulty: "easy", genre: "rock" },
            { title: "Wonderwall", artist: "Oasis", minNote: 48, maxNote: 60, difficulty: "easy", genre: "rock" },
            { title: "Don't Look Back in Anger", artist: "Oasis", minNote: 48, maxNote: 62, difficulty: "medium", genre: "rock" },
            { title: "Champagne Supernova", artist: "Oasis", minNote: 47, maxNote: 60, difficulty: "medium", genre: "rock" },
            { title: "Margaritaville", artist: "Jimmy Buffett", minNote: 45, maxNote: 55, difficulty: "easy", genre: "pop" },
            { title: "Cheeseburger in Paradise", artist: "Jimmy Buffett", minNote: 45, maxNote: 57, difficulty: "easy", genre: "pop" },
            { title: "Santeria", artist: "Sublime", minNote: 48, maxNote: 58, difficulty: "easy", genre: "rock" },
            { title: "What I Got", artist: "Sublime", minNote: 45, maxNote: 55, difficulty: "easy", genre: "rock" },
            { title: "Born to Run", artist: "Bruce Springsteen", minNote: 45, maxNote: 60, difficulty: "medium", genre: "rock" },
            { title: "Dancing in the Dark", artist: "Bruce Springsteen", minNote: 47, maxNote: 60, difficulty: "medium", genre: "rock" },
            { title: "Glory Days", artist: "Bruce Springsteen", minNote: 45, maxNote: 58, difficulty: "easy", genre: "rock" },
            { title: "Thunder Road", artist: "Bruce Springsteen", minNote: 45, maxNote: 58, difficulty: "medium", genre: "rock" },
            { title: "Summer of '69", artist: "Bryan Adams", minNote: 45, maxNote: 62, difficulty: "medium", genre: "rock" },
            { title: "Everything I Do", artist: "Bryan Adams", minNote: 47, maxNote: 60, difficulty: "medium", genre: "rock" },
            { title: "Knockin' on Heaven's Door", artist: "Bob Dylan", minNote: 45, maxNote: 55, difficulty: "easy", genre: "rock" },
            { title: "Blowin' in the Wind", artist: "Bob Dylan", minNote: 45, maxNote: 55, difficulty: "easy", genre: "folk" },
            { title: "Let It Be", artist: "The Beatles", minNote: 48, maxNote: 60, difficulty: "easy", genre: "rock" },
            { title: "Hey Jude", artist: "The Beatles", minNote: 48, maxNote: 62, difficulty: "medium", genre: "rock" },
            { title: "Yesterday", artist: "The Beatles", minNote: 48, maxNote: 60, difficulty: "easy", genre: "rock" },
            { title: "Here Comes the Sun", artist: "The Beatles", minNote: 50, maxNote: 62, difficulty: "easy", genre: "rock" },
            { title: "Come Together", artist: "The Beatles", minNote: 45, maxNote: 55, difficulty: "easy", genre: "rock" },
            { title: "Twist and Shout", artist: "The Beatles", minNote: 50, maxNote: 64, difficulty: "medium", genre: "rock" },
            { title: "With or Without You", artist: "U2", minNote: 48, maxNote: 62, difficulty: "medium", genre: "rock" },
            { title: "One", artist: "U2", minNote: 48, maxNote: 60, difficulty: "medium", genre: "rock" },
            { title: "Every Breath You Take", artist: "The Police", minNote: 48, maxNote: 60, difficulty: "easy", genre: "rock" },
            { title: "Message in a Bottle", artist: "The Police", minNote: 50, maxNote: 62, difficulty: "medium", genre: "rock" },
            { title: "Under the Bridge", artist: "Red Hot Chili Peppers", minNote: 47, maxNote: 60, difficulty: "medium", genre: "rock" },
            { title: "Californication", artist: "Red Hot Chili Peppers", minNote: 48, maxNote: 60, difficulty: "medium", genre: "rock" },
            { title: "Build Me Up Buttercup", artist: "The Foundations", minNote: 48, maxNote: 62, difficulty: "easy", genre: "pop" },
            { title: "Lean on Me", artist: "Bill Withers", minNote: 45, maxNote: 58, difficulty: "easy", genre: "soul" },
            { title: "Ain't No Sunshine", artist: "Bill Withers", minNote: 43, maxNote: 55, difficulty: "easy", genre: "soul" },
            { title: "Sitting on the Dock of the Bay", artist: "Otis Redding", minNote: 45, maxNote: 57, difficulty: "easy", genre: "soul" },
            { title: "Try a Little Tenderness", artist: "Otis Redding", minNote: 45, maxNote: 60, difficulty: "medium", genre: "soul" },
            { title: "My Girl", artist: "The Temptations", minNote: 48, maxNote: 60, difficulty: "easy", genre: "soul" },
            { title: "I Heard It Through the Grapevine", artist: "Marvin Gaye", minNote: 45, maxNote: 58, difficulty: "medium", genre: "soul" },
            { title: "Let's Get It On", artist: "Marvin Gaye", minNote: 48, maxNote: 60, difficulty: "medium", genre: "soul" },
            { title: "Sexual Healing", artist: "Marvin Gaye", minNote: 48, maxNote: 60, difficulty: "medium", genre: "soul" },
            { title: "What's Going On", artist: "Marvin Gaye", minNote: 48, maxNote: 62, difficulty: "medium", genre: "soul" },
            { title: "Superstition", artist: "Stevie Wonder", minNote: 50, maxNote: 62, difficulty: "medium", genre: "soul" },
            { title: "Signed, Sealed, Delivered", artist: "Stevie Wonder", minNote: 50, maxNote: 62, difficulty: "medium", genre: "soul" },
            { title: "Isn't She Lovely", artist: "Stevie Wonder", minNote: 50, maxNote: 65, difficulty: "medium", genre: "soul" },
            { title: "I Just Called to Say I Love You", artist: "Stevie Wonder", minNote: 48, maxNote: 60, difficulty: "easy", genre: "pop" },
            { title: "Fly Me to the Moon", artist: "Frank Sinatra", minNote: 45, maxNote: 58, difficulty: "medium", genre: "jazz" },
            { title: "New York, New York", artist: "Frank Sinatra", minNote: 45, maxNote: 60, difficulty: "medium", genre: "jazz" },
            { title: "My Way", artist: "Frank Sinatra", minNote: 43, maxNote: 58, difficulty: "medium", genre: "jazz" },
            { title: "The Way You Look Tonight", artist: "Frank Sinatra", minNote: 45, maxNote: 58, difficulty: "medium", genre: "jazz" },
            { title: "What a Wonderful World", artist: "Louis Armstrong", minNote: 40, maxNote: 52, difficulty: "easy", genre: "jazz" },
            { title: "Feeling Good", artist: "Michael Bubl√©", minNote: 45, maxNote: 60, difficulty: "medium", genre: "jazz" },
            { title: "Haven't Met You Yet", artist: "Michael Bubl√©", minNote: 48, maxNote: 60, difficulty: "medium", genre: "pop" },
            
            // ========== TENOR (High Male) - minNote: 48-55 ==========
            { title: "Don't Stop Believin'", artist: "Journey", minNote: 48, maxNote: 64, difficulty: "hard", genre: "rock" },
            { title: "Open Arms", artist: "Journey", minNote: 50, maxNote: 65, difficulty: "hard", genre: "rock" },
            { title: "Separate Ways", artist: "Journey", minNote: 50, maxNote: 67, difficulty: "hard", genre: "rock" },
            { title: "Faithfully", artist: "Journey", minNote: 50, maxNote: 65, difficulty: "hard", genre: "rock" },
            { title: "Livin' on a Prayer", artist: "Bon Jovi", minNote: 47, maxNote: 67, difficulty: "hard", genre: "rock" },
            { title: "You Give Love a Bad Name", artist: "Bon Jovi", minNote: 50, maxNote: 65, difficulty: "hard", genre: "rock" },
            { title: "Wanted Dead or Alive", artist: "Bon Jovi", minNote: 47, maxNote: 62, difficulty: "medium", genre: "rock" },
            { title: "It's My Life", artist: "Bon Jovi", minNote: 48, maxNote: 62, difficulty: "medium", genre: "rock" },
            { title: "Mr. Brightside", artist: "The Killers", minNote: 50, maxNote: 62, difficulty: "medium", genre: "rock" },
            { title: "Somebody Told Me", artist: "The Killers", minNote: 50, maxNote: 62, difficulty: "medium", genre: "rock" },
            { title: "Human", artist: "The Killers", minNote: 50, maxNote: 62, difficulty: "medium", genre: "rock" },
            { title: "I Want It That Way", artist: "Backstreet Boys", minNote: 50, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Everybody (Backstreet's Back)", artist: "Backstreet Boys", minNote: 50, maxNote: 62, difficulty: "medium", genre: "pop" },
            { title: "Bohemian Rhapsody", artist: "Queen", minNote: 48, maxNote: 72, difficulty: "hard", genre: "rock" },
            { title: "Somebody to Love", artist: "Queen", minNote: 50, maxNote: 70, difficulty: "hard", genre: "rock" },
            { title: "We Are the Champions", artist: "Queen", minNote: 48, maxNote: 65, difficulty: "hard", genre: "rock" },
            { title: "Don't Stop Me Now", artist: "Queen", minNote: 52, maxNote: 68, difficulty: "hard", genre: "rock" },
            { title: "Under Pressure", artist: "Queen & David Bowie", minNote: 48, maxNote: 67, difficulty: "hard", genre: "rock" },
            { title: "Radio Ga Ga", artist: "Queen", minNote: 50, maxNote: 65, difficulty: "medium", genre: "rock" },
            { title: "I Want to Break Free", artist: "Queen", minNote: 50, maxNote: 65, difficulty: "medium", genre: "rock" },
            { title: "Africa", artist: "Toto", minNote: 52, maxNote: 65, difficulty: "medium", genre: "rock" },
            { title: "Rosanna", artist: "Toto", minNote: 52, maxNote: 67, difficulty: "hard", genre: "rock" },
            { title: "Hold the Line", artist: "Toto", minNote: 52, maxNote: 65, difficulty: "medium", genre: "rock" },
            { title: "Take On Me", artist: "a-ha", minNote: 55, maxNote: 76, difficulty: "hard", genre: "pop" },
            { title: "You Shook Me All Night Long", artist: "AC/DC", minNote: 48, maxNote: 62, difficulty: "medium", genre: "rock" },
            { title: "Highway to Hell", artist: "AC/DC", minNote: 50, maxNote: 62, difficulty: "medium", genre: "rock" },
            { title: "Back in Black", artist: "AC/DC", minNote: 50, maxNote: 62, difficulty: "medium", genre: "rock" },
            { title: "TNT", artist: "AC/DC", minNote: 50, maxNote: 65, difficulty: "medium", genre: "rock" },
            { title: "Jessie's Girl", artist: "Rick Springfield", minNote: 48, maxNote: 65, difficulty: "medium", genre: "rock" },
            { title: "Pour Some Sugar on Me", artist: "Def Leppard", minNote: 52, maxNote: 67, difficulty: "hard", genre: "rock" },
            { title: "Photograph", artist: "Def Leppard", minNote: 50, maxNote: 65, difficulty: "medium", genre: "rock" },
            { title: "Here I Go Again", artist: "Whitesnake", minNote: 50, maxNote: 67, difficulty: "hard", genre: "rock" },
            { title: "Sister Christian", artist: "Night Ranger", minNote: 50, maxNote: 65, difficulty: "medium", genre: "rock" },
            { title: "More Than a Feeling", artist: "Boston", minNote: 52, maxNote: 67, difficulty: "hard", genre: "rock" },
            { title: "Dream On", artist: "Aerosmith", minNote: 48, maxNote: 70, difficulty: "hard", genre: "rock" },
            { title: "I Don't Want to Miss a Thing", artist: "Aerosmith", minNote: 50, maxNote: 67, difficulty: "hard", genre: "rock" },
            { title: "Sweet Emotion", artist: "Aerosmith", minNote: 48, maxNote: 62, difficulty: "medium", genre: "rock" },
            { title: "Walk This Way", artist: "Aerosmith", minNote: 50, maxNote: 65, difficulty: "medium", genre: "rock" },
            { title: "November Rain", artist: "Guns N' Roses", minNote: 48, maxNote: 67, difficulty: "hard", genre: "rock" },
            { title: "Sweet Child O' Mine", artist: "Guns N' Roses", minNote: 50, maxNote: 70, difficulty: "hard", genre: "rock" },
            { title: "Paradise City", artist: "Guns N' Roses", minNote: 50, maxNote: 67, difficulty: "hard", genre: "rock" },
            { title: "Welcome to the Jungle", artist: "Guns N' Roses", minNote: 50, maxNote: 67, difficulty: "hard", genre: "rock" },
            { title: "Patience", artist: "Guns N' Roses", minNote: 48, maxNote: 62, difficulty: "medium", genre: "rock" },
            { title: "Enter Sandman", artist: "Metallica", minNote: 48, maxNote: 60, difficulty: "medium", genre: "rock" },
            { title: "Nothing Else Matters", artist: "Metallica", minNote: 48, maxNote: 60, difficulty: "medium", genre: "rock" },
            { title: "Smells Like Teen Spirit", artist: "Nirvana", minNote: 48, maxNote: 60, difficulty: "medium", genre: "rock" },
            { title: "Come As You Are", artist: "Nirvana", minNote: 48, maxNote: 58, difficulty: "easy", genre: "rock" },
            { title: "Learn to Fly", artist: "Foo Fighters", minNote: 50, maxNote: 62, difficulty: "medium", genre: "rock" },
            { title: "Everlong", artist: "Foo Fighters", minNote: 50, maxNote: 65, difficulty: "medium", genre: "rock" },
            { title: "Best of You", artist: "Foo Fighters", minNote: 50, maxNote: 67, difficulty: "hard", genre: "rock" },
            { title: "Creep", artist: "Radiohead", minNote: 48, maxNote: 62, difficulty: "medium", genre: "rock" },
            { title: "Yellow", artist: "Coldplay", minNote: 50, maxNote: 62, difficulty: "easy", genre: "rock" },
            { title: "The Scientist", artist: "Coldplay", minNote: 48, maxNote: 62, difficulty: "easy", genre: "rock" },
            { title: "Fix You", artist: "Coldplay", minNote: 50, maxNote: 65, difficulty: "medium", genre: "rock" },
            { title: "Viva la Vida", artist: "Coldplay", minNote: 52, maxNote: 65, difficulty: "medium", genre: "rock" },
            { title: "Clocks", artist: "Coldplay", minNote: 50, maxNote: 65, difficulty: "medium", genre: "rock" },
            { title: "Crazy", artist: "Gnarls Barkley", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Uptown Funk", artist: "Bruno Mars", minNote: 50, maxNote: 62, difficulty: "medium", genre: "pop" },
            { title: "Just the Way You Are", artist: "Bruno Mars", minNote: 50, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Grenade", artist: "Bruno Mars", minNote: 52, maxNote: 67, difficulty: "hard", genre: "pop" },
            { title: "Locked Out of Heaven", artist: "Bruno Mars", minNote: 50, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Treasure", artist: "Bruno Mars", minNote: 50, maxNote: 62, difficulty: "medium", genre: "pop" },
            { title: "When I Was Your Man", artist: "Bruno Mars", minNote: 50, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Happy", artist: "Pharrell Williams", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Get Lucky", artist: "Daft Punk ft. Pharrell", minNote: 50, maxNote: 62, difficulty: "easy", genre: "pop" },
            { title: "Blinding Lights", artist: "The Weeknd", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Starboy", artist: "The Weeknd", minNote: 50, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Can't Feel My Face", artist: "The Weeknd", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Shape of You", artist: "Ed Sheeran", minNote: 48, maxNote: 60, difficulty: "easy", genre: "pop" },
            { title: "Perfect", artist: "Ed Sheeran", minNote: 48, maxNote: 62, difficulty: "easy", genre: "pop" },
            { title: "Thinking Out Loud", artist: "Ed Sheeran", minNote: 48, maxNote: 62, difficulty: "easy", genre: "pop" },
            { title: "Castle on the Hill", artist: "Ed Sheeran", minNote: 50, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Photograph", artist: "Ed Sheeran", minNote: 48, maxNote: 62, difficulty: "easy", genre: "pop" },
            { title: "Stay With Me", artist: "Sam Smith", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Too Good at Goodbyes", artist: "Sam Smith", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "All of Me", artist: "John Legend", minNote: 50, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Ordinary People", artist: "John Legend", minNote: 48, maxNote: 62, difficulty: "medium", genre: "pop" },
            { title: "Sorry", artist: "Justin Bieber", minNote: 52, maxNote: 65, difficulty: "easy", genre: "pop" },
            { title: "Love Yourself", artist: "Justin Bieber", minNote: 50, maxNote: 62, difficulty: "easy", genre: "pop" },
            { title: "Peaches", artist: "Justin Bieber", minNote: 48, maxNote: 60, difficulty: "easy", genre: "pop" },
            { title: "Sugar", artist: "Maroon 5", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Moves Like Jagger", artist: "Maroon 5", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "She Will Be Loved", artist: "Maroon 5", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "This Love", artist: "Maroon 5", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Payphone", artist: "Maroon 5", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Girls Like You", artist: "Maroon 5", minNote: 50, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Memories", artist: "Maroon 5", minNote: 52, maxNote: 65, difficulty: "easy", genre: "pop" },
            { title: "Counting Stars", artist: "OneRepublic", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Apologize", artist: "OneRepublic", minNote: 50, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Stitches", artist: "Shawn Mendes", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Treat You Better", artist: "Shawn Mendes", minNote: 50, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "There's Nothing Holdin' Me Back", artist: "Shawn Mendes", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Se√±orita", artist: "Shawn Mendes & Camila Cabello", minNote: 50, maxNote: 62, difficulty: "easy", genre: "pop" },
            { title: "Watermelon Sugar", artist: "Harry Styles", minNote: 50, maxNote: 62, difficulty: "easy", genre: "pop" },
            { title: "As It Was", artist: "Harry Styles", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Sign of the Times", artist: "Harry Styles", minNote: 50, maxNote: 67, difficulty: "hard", genre: "pop" },
            { title: "Adore You", artist: "Harry Styles", minNote: 50, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Levitating", artist: "Dua Lipa (male key)", minNote: 50, maxNote: 62, difficulty: "medium", genre: "pop" },
            
            // ========== ALTO (Low Female) - minNote: 50-58 ==========
            { title: "Respect", artist: "Aretha Franklin", minNote: 52, maxNote: 67, difficulty: "medium", genre: "soul" },
            { title: "Natural Woman", artist: "Aretha Franklin", minNote: 52, maxNote: 67, difficulty: "medium", genre: "soul" },
            { title: "Think", artist: "Aretha Franklin", minNote: 52, maxNote: 65, difficulty: "medium", genre: "soul" },
            { title: "Chain of Fools", artist: "Aretha Franklin", minNote: 52, maxNote: 65, difficulty: "medium", genre: "soul" },
            { title: "Valerie", artist: "Amy Winehouse", minNote: 52, maxNote: 65, difficulty: "medium", genre: "soul" },
            { title: "Rehab", artist: "Amy Winehouse", minNote: 50, maxNote: 62, difficulty: "medium", genre: "soul" },
            { title: "Back to Black", artist: "Amy Winehouse", minNote: 52, maxNote: 65, difficulty: "medium", genre: "soul" },
            { title: "These Boots Are Made for Walking", artist: "Nancy Sinatra", minNote: 50, maxNote: 60, difficulty: "easy", genre: "pop" },
            { title: "Landslide", artist: "Fleetwood Mac", minNote: 52, maxNote: 64, difficulty: "medium", genre: "rock" },
            { title: "Dreams", artist: "Fleetwood Mac", minNote: 55, maxNote: 67, difficulty: "easy", genre: "rock" },
            { title: "The Chain", artist: "Fleetwood Mac", minNote: 52, maxNote: 65, difficulty: "medium", genre: "rock" },
            { title: "Everywhere", artist: "Fleetwood Mac", minNote: 55, maxNote: 67, difficulty: "easy", genre: "rock" },
            { title: "Gypsy", artist: "Fleetwood Mac", minNote: 52, maxNote: 65, difficulty: "medium", genre: "rock" },
            { title: "Go Your Own Way", artist: "Fleetwood Mac", minNote: 52, maxNote: 65, difficulty: "medium", genre: "rock" },
            { title: "Jolene", artist: "Dolly Parton", minNote: 52, maxNote: 68, difficulty: "medium", genre: "country" },
            { title: "9 to 5", artist: "Dolly Parton", minNote: 55, maxNote: 68, difficulty: "medium", genre: "country" },
            { title: "I Will Always Love You", artist: "Dolly Parton", minNote: 50, maxNote: 65, difficulty: "medium", genre: "country" },
            { title: "Coat of Many Colors", artist: "Dolly Parton", minNote: 52, maxNote: 65, difficulty: "easy", genre: "country" },
            { title: "Piece of My Heart", artist: "Janis Joplin", minNote: 52, maxNote: 67, difficulty: "hard", genre: "rock" },
            { title: "Me and Bobby McGee", artist: "Janis Joplin", minNote: 50, maxNote: 65, difficulty: "medium", genre: "rock" },
            { title: "Summertime", artist: "Janis Joplin", minNote: 52, maxNote: 67, difficulty: "hard", genre: "rock" },
            { title: "Mercedes Benz", artist: "Janis Joplin", minNote: 50, maxNote: 60, difficulty: "easy", genre: "rock" },
            { title: "Crazy", artist: "Patsy Cline", minNote: 50, maxNote: 62, difficulty: "medium", genre: "country" },
            { title: "Walkin' After Midnight", artist: "Patsy Cline", minNote: 50, maxNote: 62, difficulty: "easy", genre: "country" },
            { title: "I Fall to Pieces", artist: "Patsy Cline", minNote: 50, maxNote: 62, difficulty: "medium", genre: "country" },
            { title: "Sweet Dreams", artist: "Patsy Cline", minNote: 50, maxNote: 62, difficulty: "medium", genre: "country" },
            { title: "Blue", artist: "LeAnn Rimes", minNote: 50, maxNote: 65, difficulty: "medium", genre: "country" },
            { title: "How Do I Live", artist: "LeAnn Rimes", minNote: 52, maxNote: 67, difficulty: "medium", genre: "country" },
            { title: "Fancy", artist: "Reba McEntire", minNote: 52, maxNote: 67, difficulty: "medium", genre: "country" },
            { title: "Before He Cheats", artist: "Carrie Underwood", minNote: 52, maxNote: 67, difficulty: "medium", genre: "country" },
            { title: "Jesus, Take the Wheel", artist: "Carrie Underwood", minNote: 52, maxNote: 67, difficulty: "medium", genre: "country" },
            { title: "Cowboy Casanova", artist: "Carrie Underwood", minNote: 52, maxNote: 67, difficulty: "medium", genre: "country" },
            { title: "Bless the Broken Road", artist: "Rascal Flatts", minNote: 50, maxNote: 65, difficulty: "medium", genre: "country" },
            { title: "Need You Now", artist: "Lady A", minNote: 50, maxNote: 65, difficulty: "medium", genre: "country" },
            { title: "You Belong With Me", artist: "Taylor Swift", minNote: 52, maxNote: 67, difficulty: "easy", genre: "pop" },
            { title: "Love Story", artist: "Taylor Swift", minNote: 52, maxNote: 67, difficulty: "easy", genre: "pop" },
            { title: "Shake It Off", artist: "Taylor Swift", minNote: 55, maxNote: 67, difficulty: "easy", genre: "pop" },
            { title: "Blank Space", artist: "Taylor Swift", minNote: 50, maxNote: 65, difficulty: "easy", genre: "pop" },
            { title: "Bad Blood", artist: "Taylor Swift", minNote: 52, maxNote: 65, difficulty: "easy", genre: "pop" },
            { title: "Teardrops on My Guitar", artist: "Taylor Swift", minNote: 52, maxNote: 65, difficulty: "easy", genre: "country" },
            { title: "We Are Never Getting Back Together", artist: "Taylor Swift", minNote: 52, maxNote: 67, difficulty: "easy", genre: "pop" },
            { title: "22", artist: "Taylor Swift", minNote: 52, maxNote: 65, difficulty: "easy", genre: "pop" },
            { title: "Anti-Hero", artist: "Taylor Swift", minNote: 50, maxNote: 62, difficulty: "easy", genre: "pop" },
            { title: "Cruel Summer", artist: "Taylor Swift", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Call Me Maybe", artist: "Carly Rae Jepsen", minNote: 55, maxNote: 67, difficulty: "easy", genre: "pop" },
            { title: "Since U Been Gone", artist: "Kelly Clarkson", minNote: 52, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "Stronger", artist: "Kelly Clarkson", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Behind These Hazel Eyes", artist: "Kelly Clarkson", minNote: 52, maxNote: 68, difficulty: "hard", genre: "pop" },
            { title: "Breakaway", artist: "Kelly Clarkson", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Because of You", artist: "Kelly Clarkson", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Mr. Know It All", artist: "Kelly Clarkson", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Complicated", artist: "Avril Lavigne", minNote: 52, maxNote: 65, difficulty: "easy", genre: "rock" },
            { title: "Sk8er Boi", artist: "Avril Lavigne", minNote: 52, maxNote: 67, difficulty: "medium", genre: "rock" },
            { title: "I'm With You", artist: "Avril Lavigne", minNote: 50, maxNote: 62, difficulty: "easy", genre: "rock" },
            { title: "Girlfriend", artist: "Avril Lavigne", minNote: 52, maxNote: 67, difficulty: "easy", genre: "rock" },
            { title: "Roar", artist: "Katy Perry", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Firework", artist: "Katy Perry", minNote: 55, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "Hot N Cold", artist: "Katy Perry", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Teenage Dream", artist: "Katy Perry", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "California Gurls", artist: "Katy Perry", minNote: 52, maxNote: 65, difficulty: "easy", genre: "pop" },
            { title: "Part of Me", artist: "Katy Perry", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Dark Horse", artist: "Katy Perry", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Born This Way", artist: "Lady Gaga", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Poker Face", artist: "Lady Gaga", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Bad Romance", artist: "Lady Gaga", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Just Dance", artist: "Lady Gaga", minNote: 52, maxNote: 65, difficulty: "easy", genre: "pop" },
            { title: "Paparazzi", artist: "Lady Gaga", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Edge of Glory", artist: "Lady Gaga", minNote: 52, maxNote: 67, difficulty: "hard", genre: "pop" },
            { title: "Shallow", artist: "Lady Gaga & Bradley Cooper", minNote: 48, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "Always Remember Us This Way", artist: "Lady Gaga", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Single Ladies", artist: "Beyonc√©", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Crazy in Love", artist: "Beyonc√©", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Halo", artist: "Beyonc√©", minNote: 52, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "If I Were a Boy", artist: "Beyonc√©", minNote: 50, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Love on Top", artist: "Beyonc√©", minNote: 55, maxNote: 72, difficulty: "hard", genre: "pop" },
            { title: "Irreplaceable", artist: "Beyonc√©", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Run the World (Girls)", artist: "Beyonc√©", minNote: 55, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Toxic", artist: "Britney Spears", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Baby One More Time", artist: "Britney Spears", minNote: 52, maxNote: 65, difficulty: "easy", genre: "pop" },
            { title: "Oops!... I Did It Again", artist: "Britney Spears", minNote: 52, maxNote: 65, difficulty: "easy", genre: "pop" },
            { title: "Stronger", artist: "Britney Spears", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Womanizer", artist: "Britney Spears", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Since U Been Gone", artist: "Kelly Clarkson", minNote: 52, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "Like a Prayer", artist: "Madonna", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Material Girl", artist: "Madonna", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Vogue", artist: "Madonna", minNote: 50, maxNote: 62, difficulty: "easy", genre: "pop" },
            { title: "Like a Virgin", artist: "Madonna", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Express Yourself", artist: "Madonna", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Hung Up", artist: "Madonna", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            
            // ========== MEZZO-SOPRANO (Mid Female) - minNote: 55-63 ==========
            { title: "I Will Survive", artist: "Gloria Gaynor", minNote: 55, maxNote: 67, difficulty: "medium", genre: "disco" },
            { title: "Girls Just Want to Have Fun", artist: "Cyndi Lauper", minNote: 55, maxNote: 69, difficulty: "medium", genre: "pop" },
            { title: "Time After Time", artist: "Cyndi Lauper", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "True Colors", artist: "Cyndi Lauper", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Total Eclipse of the Heart", artist: "Bonnie Tyler", minNote: 50, maxNote: 68, difficulty: "hard", genre: "rock" },
            { title: "Holding Out for a Hero", artist: "Bonnie Tyler", minNote: 52, maxNote: 70, difficulty: "hard", genre: "rock" },
            { title: "Dancing Queen", artist: "ABBA", minNote: 55, maxNote: 70, difficulty: "medium", genre: "pop" },
            { title: "Mamma Mia", artist: "ABBA", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Take a Chance on Me", artist: "ABBA", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Fernando", artist: "ABBA", minNote: 52, maxNote: 65, difficulty: "easy", genre: "pop" },
            { title: "Waterloo", artist: "ABBA", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "SOS", artist: "ABBA", minNote: 55, maxNote: 68, difficulty: "medium", genre: "pop" },
            { title: "Gimme! Gimme! Gimme!", artist: "ABBA", minNote: 55, maxNote: 68, difficulty: "medium", genre: "pop" },
            { title: "Super Trouper", artist: "ABBA", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "The Winner Takes It All", artist: "ABBA", minNote: 55, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "Love Shack", artist: "B-52s", minNote: 53, maxNote: 68, difficulty: "medium", genre: "rock" },
            { title: "Rock Lobster", artist: "B-52s", minNote: 50, maxNote: 65, difficulty: "medium", genre: "rock" },
            { title: "Walking on Sunshine", artist: "Katrina and the Waves", minNote: 55, maxNote: 68, difficulty: "medium", genre: "pop" },
            { title: "Man! I Feel Like a Woman!", artist: "Shania Twain", minNote: 55, maxNote: 67, difficulty: "medium", genre: "country" },
            { title: "That Don't Impress Me Much", artist: "Shania Twain", minNote: 50, maxNote: 65, difficulty: "easy", genre: "country" },
            { title: "You're Still the One", artist: "Shania Twain", minNote: 55, maxNote: 67, difficulty: "easy", genre: "country" },
            { title: "From This Moment On", artist: "Shania Twain", minNote: 55, maxNote: 70, difficulty: "hard", genre: "country" },
            { title: "Wannabe", artist: "Spice Girls", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Say You'll Be There", artist: "Spice Girls", minNote: 55, maxNote: 65, difficulty: "easy", genre: "pop" },
            { title: "2 Become 1", artist: "Spice Girls", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Viva Forever", artist: "Spice Girls", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "No Scrubs", artist: "TLC", minNote: 52, maxNote: 65, difficulty: "medium", genre: "rnb" },
            { title: "Waterfalls", artist: "TLC", minNote: 50, maxNote: 65, difficulty: "medium", genre: "rnb" },
            { title: "Creep", artist: "TLC", minNote: 52, maxNote: 65, difficulty: "medium", genre: "rnb" },
            { title: "Vision of Love", artist: "Mariah Carey", minNote: 50, maxNote: 72, difficulty: "hard", genre: "pop" },
            { title: "Hero", artist: "Mariah Carey", minNote: 52, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "Always Be My Baby", artist: "Mariah Carey", minNote: 55, maxNote: 72, difficulty: "hard", genre: "pop" },
            { title: "Fantasy", artist: "Mariah Carey", minNote: 55, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "We Belong Together", artist: "Mariah Carey", minNote: 52, maxNote: 68, difficulty: "hard", genre: "pop" },
            { title: "All I Want for Christmas Is You", artist: "Mariah Carey", minNote: 55, maxNote: 72, difficulty: "hard", genre: "pop" },
            { title: "I Will Always Love You", artist: "Whitney Houston", minNote: 48, maxNote: 72, difficulty: "hard", genre: "pop" },
            { title: "Greatest Love of All", artist: "Whitney Houston", minNote: 52, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "I Wanna Dance with Somebody", artist: "Whitney Houston", minNote: 55, maxNote: 72, difficulty: "hard", genre: "pop" },
            { title: "How Will I Know", artist: "Whitney Houston", minNote: 55, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "Saving All My Love for You", artist: "Whitney Houston", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Rolling in the Deep", artist: "Adele", minNote: 50, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Someone Like You", artist: "Adele", minNote: 50, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Hello", artist: "Adele", minNote: 50, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Set Fire to the Rain", artist: "Adele", minNote: 55, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "Skyfall", artist: "Adele", minNote: 50, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Easy on Me", artist: "Adele", minNote: 50, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Chasing Pavements", artist: "Adele", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Make You Feel My Love", artist: "Adele", minNote: 50, maxNote: 62, difficulty: "easy", genre: "pop" },
            { title: "Don't Speak", artist: "No Doubt", minNote: 52, maxNote: 67, difficulty: "medium", genre: "rock" },
            { title: "Just a Girl", artist: "No Doubt", minNote: 55, maxNote: 67, difficulty: "medium", genre: "rock" },
            { title: "Underneath It All", artist: "No Doubt", minNote: 50, maxNote: 65, difficulty: "easy", genre: "rock" },
            { title: "Spiderwebs", artist: "No Doubt", minNote: 55, maxNote: 67, difficulty: "medium", genre: "rock" },
            { title: "Hollaback Girl", artist: "Gwen Stefani", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "The Sweet Escape", artist: "Gwen Stefani", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Rich Girl", artist: "Gwen Stefani", minNote: 50, maxNote: 65, difficulty: "easy", genre: "pop" },
            { title: "Umbrella", artist: "Rihanna", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Diamonds", artist: "Rihanna", minNote: 55, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "We Found Love", artist: "Rihanna", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Only Girl (In the World)", artist: "Rihanna", minNote: 55, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "Disturbia", artist: "Rihanna", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "SOS", artist: "Rihanna", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Stay", artist: "Rihanna", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Don't Stop the Music", artist: "Rihanna", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Work", artist: "Rihanna", minNote: 50, maxNote: 62, difficulty: "easy", genre: "pop" },
            { title: "Love on the Brain", artist: "Rihanna", minNote: 52, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "Tik Tok", artist: "Kesha", minNote: 52, maxNote: 65, difficulty: "easy", genre: "pop" },
            { title: "We R Who We R", artist: "Kesha", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Die Young", artist: "Kesha", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Praying", artist: "Kesha", minNote: 48, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "Titanium", artist: "David Guetta ft. Sia", minNote: 55, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "Chandelier", artist: "Sia", minNote: 50, maxNote: 72, difficulty: "hard", genre: "pop" },
            { title: "Cheap Thrills", artist: "Sia", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Elastic Heart", artist: "Sia", minNote: 50, maxNote: 68, difficulty: "hard", genre: "pop" },
            { title: "Unstoppable", artist: "Sia", minNote: 55, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "Brave", artist: "Sara Bareilles", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Love Song", artist: "Sara Bareilles", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Fight Song", artist: "Rachel Platten", minNote: 55, maxNote: 68, difficulty: "medium", genre: "pop" },
            { title: "Jar of Hearts", artist: "Christina Perri", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "A Thousand Years", artist: "Christina Perri", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Good 4 U", artist: "Olivia Rodrigo", minNote: 55, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "Drivers License", artist: "Olivia Rodrigo", minNote: 50, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Deja Vu", artist: "Olivia Rodrigo", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Traitor", artist: "Olivia Rodrigo", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Happier", artist: "Olivia Rodrigo", minNote: 50, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Vampire", artist: "Olivia Rodrigo", minNote: 50, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Thank U, Next", artist: "Ariana Grande", minNote: 55, maxNote: 72, difficulty: "hard", genre: "pop" },
            { title: "7 Rings", artist: "Ariana Grande", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Break Free", artist: "Ariana Grande", minNote: 55, maxNote: 72, difficulty: "hard", genre: "pop" },
            { title: "Problem", artist: "Ariana Grande", minNote: 55, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "No Tears Left to Cry", artist: "Ariana Grande", minNote: 55, maxNote: 72, difficulty: "hard", genre: "pop" },
            { title: "Into You", artist: "Ariana Grande", minNote: 55, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "Positions", artist: "Ariana Grande", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "34+35", artist: "Ariana Grande", minNote: 55, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "Bang Bang", artist: "Jessie J, Ariana Grande, Nicki Minaj", minNote: 55, maxNote: 72, difficulty: "hard", genre: "pop" },
            { title: "Price Tag", artist: "Jessie J", minNote: 55, maxNote: 68, difficulty: "medium", genre: "pop" },
            { title: "Domino", artist: "Jessie J", minNote: 55, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "Cheap Thrills", artist: "Sia", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "New Rules", artist: "Dua Lipa", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Levitating", artist: "Dua Lipa", minNote: 55, maxNote: 68, difficulty: "medium", genre: "pop" },
            { title: "Don't Start Now", artist: "Dua Lipa", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Physical", artist: "Dua Lipa", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "IDGAF", artist: "Dua Lipa", minNote: 52, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Break My Heart", artist: "Dua Lipa", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Flowers", artist: "Miley Cyrus", minNote: 50, maxNote: 65, difficulty: "easy", genre: "pop" },
            { title: "Wrecking Ball", artist: "Miley Cyrus", minNote: 55, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "Party in the U.S.A.", artist: "Miley Cyrus", minNote: 55, maxNote: 67, difficulty: "easy", genre: "pop" },
            { title: "We Can't Stop", artist: "Miley Cyrus", minNote: 50, maxNote: 62, difficulty: "easy", genre: "pop" },
            { title: "Malibu", artist: "Miley Cyrus", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Midnight Sky", artist: "Miley Cyrus", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "About Damn Time", artist: "Lizzo", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Good as Hell", artist: "Lizzo", minNote: 55, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Truth Hurts", artist: "Lizzo", minNote: 50, maxNote: 65, difficulty: "medium", genre: "pop" },
            { title: "Juice", artist: "Lizzo", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Havana", artist: "Camila Cabello", minNote: 50, maxNote: 65, difficulty: "easy", genre: "pop" },
            { title: "Never Be the Same", artist: "Camila Cabello", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            { title: "Espresso", artist: "Sabrina Carpenter", minNote: 52, maxNote: 67, difficulty: "medium", genre: "pop" },
            
            // ========== SOPRANO (High Female) - minNote: 60+ ==========
            { title: "Emotions", artist: "Mariah Carey", minNote: 55, maxNote: 79, difficulty: "hard", genre: "pop" },
            { title: "My Heart Will Go On", artist: "Celine Dion", minNote: 55, maxNote: 72, difficulty: "hard", genre: "pop" },
            { title: "The Power of Love", artist: "Celine Dion", minNote: 52, maxNote: 72, difficulty: "hard", genre: "pop" },
            { title: "Because You Loved Me", artist: "Celine Dion", minNote: 55, maxNote: 70, difficulty: "hard", genre: "pop" },
            { title: "It's All Coming Back to Me Now", artist: "Celine Dion", minNote: 50, maxNote: 72, difficulty: "hard", genre: "pop" },
            { title: "All By Myself", artist: "Celine Dion", minNote: 52, maxNote: 75, difficulty: "hard", genre: "pop" },
            { title: "Ave Maria", artist: "Traditional", minNote: 55, maxNote: 72, difficulty: "hard", genre: "classical" },
            { title: "O Holy Night", artist: "Traditional", minNote: 55, maxNote: 72, difficulty: "hard", genre: "classical" },
            { title: "Memory", artist: "from Cats", minNote: 55, maxNote: 70, difficulty: "hard", genre: "musical" },
            { title: "Don't Cry for Me Argentina", artist: "from Evita", minNote: 55, maxNote: 70, difficulty: "hard", genre: "musical" },
            { title: "Defying Gravity", artist: "from Wicked", minNote: 52, maxNote: 72, difficulty: "hard", genre: "musical" },
            { title: "I Dreamed a Dream", artist: "from Les Mis√©rables", minNote: 52, maxNote: 70, difficulty: "hard", genre: "musical" },
            { title: "On My Own", artist: "from Les Mis√©rables", minNote: 55, maxNote: 70, difficulty: "hard", genre: "musical" },
            { title: "And I Am Telling You I'm Not Going", artist: "from Dreamgirls", minNote: 52, maxNote: 75, difficulty: "hard", genre: "musical" },
            { title: "Listen", artist: "from Dreamgirls", minNote: 55, maxNote: 72, difficulty: "hard", genre: "musical" },
            { title: "Think of Me", artist: "from Phantom of the Opera", minNote: 60, maxNote: 79, difficulty: "hard", genre: "musical" },
            { title: "The Phantom of the Opera", artist: "from Phantom of the Opera", minNote: 55, maxNote: 75, difficulty: "hard", genre: "musical" },
            { title: "All I Ask of You", artist: "from Phantom of the Opera", minNote: 55, maxNote: 70, difficulty: "hard", genre: "musical" },
            { title: "Part of Your World", artist: "from The Little Mermaid", minNote: 55, maxNote: 72, difficulty: "medium", genre: "disney" },
            { title: "Let It Go", artist: "from Frozen", minNote: 55, maxNote: 72, difficulty: "hard", genre: "disney" },
            { title: "Into the Unknown", artist: "from Frozen 2", minNote: 55, maxNote: 75, difficulty: "hard", genre: "disney" },
            { title: "A Whole New World", artist: "from Aladdin", minNote: 55, maxNote: 70, difficulty: "medium", genre: "disney" },
            { title: "Beauty and the Beast", artist: "from Beauty and the Beast", minNote: 55, maxNote: 67, difficulty: "medium", genre: "disney" },
            { title: "Tale as Old as Time", artist: "from Beauty and the Beast", minNote: 55, maxNote: 67, difficulty: "easy", genre: "disney" },
            { title: "Colors of the Wind", artist: "from Pocahontas", minNote: 55, maxNote: 70, difficulty: "medium", genre: "disney" },
            { title: "Reflection", artist: "from Mulan", minNote: 55, maxNote: 70, difficulty: "medium", genre: "disney" },
            { title: "Can You Feel the Love Tonight", artist: "from The Lion King", minNote: 50, maxNote: 65, difficulty: "medium", genre: "disney" },
            { title: "Circle of Life", artist: "from The Lion King", minNote: 55, maxNote: 70, difficulty: "hard", genre: "disney" },
            { title: "How Far I'll Go", artist: "from Moana", minNote: 55, maxNote: 70, difficulty: "hard", genre: "disney" },
            { title: "Surface Pressure", artist: "from Encanto", minNote: 55, maxNote: 70, difficulty: "hard", genre: "disney" },
            { title: "We Don't Talk About Bruno", artist: "from Encanto", minNote: 50, maxNote: 65, difficulty: "medium", genre: "disney" },
            { title: "Somewhere Over the Rainbow", artist: "from The Wizard of Oz", minNote: 55, maxNote: 72, difficulty: "hard", genre: "musical" },
        ];

        // State
        let isRecording = false;
        let audioContext = null;
        let analyser = null;
        let stream = null;
        let pitches = [];
        let recordingTime = 0;
        let timerInterval = null;
        let animationId = null;

        // DOM elements
        const visualizer = document.getElementById('visualizer');
        const timer = document.getElementById('timer');
        const instructions = document.getElementById('instructions');
        const status = document.getElementById('status');
        const sampleCount = document.getElementById('sample-count');
        const recordBtn = document.getElementById('record-btn');
        const btnHint = document.getElementById('btn-hint');
        const analyzing = document.getElementById('analyzing');
        const results = document.getElementById('results');
        const recordSection = document.getElementById('record-section');
        const errorContainer = document.getElementById('error-container');

        // Initialize visualizer bars
        for (let i = 0; i < 32; i++) {
            const bar = document.createElement('div');
            bar.className = 'visualizer-bar';
            visualizer.appendChild(bar);
        }
        const bars = visualizer.querySelectorAll('.visualizer-bar');

        // Utility functions
        function midiToNoteName(midi) {
            const notes = ['C', 'C#', 'D', 'D#', 'E', 'F', 'F#', 'G', 'G#', 'A', 'A#', 'B'];
            const octave = Math.floor(midi / 12) - 1;
            return notes[midi % 12] + octave;
        }

        function freqToMidi(freq) {
            return 12 * Math.log2(freq / 440) + 69;
        }

        // Improved YIN-based pitch detection algorithm
        function detectPitch(buffer, sampleRate) {
            const SIZE = buffer.length;
            const yinBufferSize = Math.floor(SIZE / 2);
            const yinBuffer = new Float32Array(yinBufferSize);
            const threshold = 0.15; // YIN threshold for pitch confidence
            
            // Calculate RMS for volume threshold
            let rms = 0;
            for (let i = 0; i < SIZE; i++) {
                rms += buffer[i] * buffer[i];
            }
            rms = Math.sqrt(rms / SIZE);
            if (rms < 0.008) return { freq: -1, confidence: 0 }; // Too quiet
            
            // Step 1: Calculate difference function
            for (let tau = 0; tau < yinBufferSize; tau++) {
                yinBuffer[tau] = 0;
                for (let i = 0; i < yinBufferSize; i++) {
                    const delta = buffer[i] - buffer[i + tau];
                    yinBuffer[tau] += delta * delta;
                }
            }
            
            // Step 2: Cumulative mean normalized difference
            yinBuffer[0] = 1;
            let runningSum = 0;
            for (let tau = 1; tau < yinBufferSize; tau++) {
                runningSum += yinBuffer[tau];
                yinBuffer[tau] *= tau / runningSum;
            }
            
            // Step 3: Absolute threshold - find first dip below threshold
            let tauEstimate = -1;
            for (let tau = 2; tau < yinBufferSize; tau++) {
                if (yinBuffer[tau] < threshold) {
                    while (tau + 1 < yinBufferSize && yinBuffer[tau + 1] < yinBuffer[tau]) {
                        tau++;
                    }
                    tauEstimate = tau;
                    break;
                }
            }
            
            // No pitch found
            if (tauEstimate === -1) return { freq: -1, confidence: 0 };
            
            // Step 4: Parabolic interpolation for better precision
            let betterTau;
            const x0 = tauEstimate < 1 ? tauEstimate : tauEstimate - 1;
            const x2 = tauEstimate + 1 < yinBufferSize ? tauEstimate + 1 : tauEstimate;
            
            if (x0 === tauEstimate) {
                betterTau = yinBuffer[tauEstimate] <= yinBuffer[x2] ? tauEstimate : x2;
            } else if (x2 === tauEstimate) {
                betterTau = yinBuffer[tauEstimate] <= yinBuffer[x0] ? tauEstimate : x0;
            } else {
                const s0 = yinBuffer[x0];
                const s1 = yinBuffer[tauEstimate];
                const s2 = yinBuffer[x2];
                betterTau = tauEstimate + (s2 - s0) / (2 * (2 * s1 - s2 - s0));
            }
            
            const freq = sampleRate / betterTau;
            const confidence = 1 - yinBuffer[tauEstimate];
            
            // Filter unreasonable frequencies (human voice range ~80Hz to ~1100Hz)
            if (freq < 75 || freq > 1200) return { freq: -1, confidence: 0 };
            
            return { freq, confidence };
        }
        
        // Track pitch samples with confidence and timing
        let pitchSamples = []; // { midi, confidence, timestamp }
        
        // Advanced analysis functions
        function calculateAdvancedMetrics(samples) {
            if (samples.length < 20) return null;
            
            // Filter by confidence
            const confident = samples.filter(s => s.confidence > 0.7);
            if (confident.length < 10) return null;
            
            const midiValues = confident.map(s => s.midi);
            
            // IQR-based outlier removal
            const sorted = [...midiValues].sort((a, b) => a - b);
            const q1 = sorted[Math.floor(sorted.length * 0.25)];
            const q3 = sorted[Math.floor(sorted.length * 0.75)];
            const iqr = q3 - q1;
            const lowerBound = q1 - 1.5 * iqr;
            const upperBound = q3 + 1.5 * iqr;
            const filtered = midiValues.filter(m => m >= lowerBound && m <= upperBound);
            
            if (filtered.length < 10) return null;
            
            // Core metrics
            const minMidi = Math.min(...filtered);
            const maxMidi = Math.max(...filtered);
            const avgMidi = filtered.reduce((a, b) => a + b, 0) / filtered.length;
            const range = maxMidi - minMidi;
            
            // Find "comfortable" range (middle 60% of notes sung)
            const comfortSorted = [...filtered].sort((a, b) => a - b);
            const comfortStart = Math.floor(comfortSorted.length * 0.2);
            const comfortEnd = Math.floor(comfortSorted.length * 0.8);
            const comfortZone = comfortSorted.slice(comfortStart, comfortEnd);
            const comfortLow = Math.min(...comfortZone);
            const comfortHigh = Math.max(...comfortZone);
            
            // Stability: standard deviation of pitch
            const variance = filtered.reduce((sum, n) => sum + Math.pow(n - avgMidi, 2), 0) / filtered.length;
            const stdDev = Math.sqrt(variance);
            const stability = Math.max(0, Math.min(100, 100 - stdDev * 8));
            
            // Pitch consistency: how often they hit intended notes (measured by clustering)
            const noteGroups = {};
            filtered.forEach(m => {
                const roundedNote = Math.round(m);
                noteGroups[roundedNote] = (noteGroups[roundedNote] || 0) + 1;
            });
            const totalNotes = filtered.length;
            const dominantNotes = Object.values(noteGroups).sort((a, b) => b - a).slice(0, 5);
            const consistency = Math.min(100, (dominantNotes.reduce((a, b) => a + b, 0) / totalNotes) * 100);
            
            // Detect vibrato (pitch oscillation patterns)
            let vibratoCount = 0;
            const windowSize = 10;
            for (let i = windowSize; i < filtered.length - windowSize; i++) {
                const before = filtered.slice(i - windowSize, i);
                const after = filtered.slice(i, i + windowSize);
                const beforeAvg = before.reduce((a, b) => a + b, 0) / before.length;
                const afterAvg = after.reduce((a, b) => a + b, 0) / after.length;
                if (Math.abs(filtered[i] - beforeAvg) > 0.3 && Math.abs(filtered[i] - afterAvg) > 0.3) {
                    vibratoCount++;
                }
            }
            const vibratoPresence = Math.min(100, (vibratoCount / filtered.length) * 500);
            
            // Breath control estimate (consistency over time segments)
            const segmentSize = Math.floor(confident.length / 4);
            const segments = [];
            for (let i = 0; i < 4; i++) {
                const seg = confident.slice(i * segmentSize, (i + 1) * segmentSize);
                if (seg.length > 0) {
                    const segAvgConf = seg.reduce((a, b) => a + b.confidence, 0) / seg.length;
                    segments.push(segAvgConf);
                }
            }
            const breathControl = segments.length > 0 
                ? Math.min(100, (segments.reduce((a, b) => a + b, 0) / segments.length) * 110)
                : 50;
            
            // Determine voice type with more nuance
            let voiceType, voiceEmoji;
            if (avgMidi < 46) { voiceType = 'Bass'; voiceEmoji = 'üé∏'; }
            else if (avgMidi < 51) { voiceType = 'Baritone'; voiceEmoji = 'üé∑'; }
            else if (avgMidi < 56) { voiceType = 'Tenor'; voiceEmoji = 'üé∫'; }
            else if (avgMidi < 61) { voiceType = 'Alto'; voiceEmoji = 'üéª'; }
            else if (avgMidi < 66) { voiceType = 'Mezzo-Soprano'; voiceEmoji = 'üéπ'; }
            else { voiceType = 'Soprano'; voiceEmoji = '‚ú®'; }
            
            return {
                minMidi, maxMidi, avgMidi, range,
                comfortLow, comfortHigh,
                stability: Math.round(stability),
                consistency: Math.round(consistency),
                vibratoPresence: Math.round(vibratoPresence),
                breathControl: Math.round(breathControl),
                voiceType, voiceEmoji,
                sampleCount: filtered.length,
                confidentSamples: confident.length
            };
        }

        function showError(message) {
            errorContainer.innerHTML = `
                <div class="error-box">
                    <p>${message}</p>
                    <a href="#" onclick="location.reload()">Try again</a>
                </div>
            `;
        }

        async function startRecording() {
            try {
                errorContainer.innerHTML = '';
                pitches = [];
                pitchSamples = [];
                recordingTime = 0;

                stream = await navigator.mediaDevices.getUserMedia({
                    audio: { echoCancellation: true, noiseSuppression: true, autoGainControl: true }
                });

                audioContext = new (window.AudioContext || window.webkitAudioContext)();
                if (audioContext.state === 'suspended') {
                    await audioContext.resume();
                }

                analyser = audioContext.createAnalyser();
                analyser.fftSize = 2048;

                const source = audioContext.createMediaStreamSource(stream);
                source.connect(analyser);

                isRecording = true;
                recordBtn.className = 'record-btn recording';
                recordBtn.textContent = '‚èπÔ∏è';
                btnHint.textContent = 'Tap to stop';
                instructions.style.display = 'none';
                status.style.display = 'block';
                timer.style.display = 'block';

                timerInterval = setInterval(() => {
                    recordingTime++;
                    const mins = Math.floor(recordingTime / 60);
                    const secs = recordingTime % 60;
                    timer.textContent = `${mins}:${secs.toString().padStart(2, '0')}`;
                }, 1000);

                detectLoop();

            } catch (err) {
                console.error(err);
                if (err.name === 'NotAllowedError') {
                    showError('Microphone permission denied. Please allow microphone access and reload.');
                } else if (err.name === 'NotFoundError') {
                    showError('No microphone found. Please connect a microphone.');
                } else {
                    showError(`Error: ${err.message}`);
                }
            }
        }

        function detectLoop() {
            if (!isRecording || !analyser) return;

            const buffer = new Float32Array(analyser.fftSize);
            analyser.getFloatTimeDomainData(buffer);

            // Update visualizer
            const freqData = new Uint8Array(analyser.frequencyBinCount);
            analyser.getByteFrequencyData(freqData);
            const step = Math.floor(freqData.length / 32);
            bars.forEach((bar, i) => {
                const value = freqData[i * step] / 255;
                bar.style.height = `${Math.max(4, value * 100)}%`;
            });

            // Detect pitch with confidence
            const result = detectPitch(buffer, audioContext.sampleRate);
            if (result.freq > 0 && result.confidence > 0.5) {
                const midi = freqToMidi(result.freq);
                pitchSamples.push({
                    midi,
                    confidence: result.confidence,
                    timestamp: Date.now()
                });
                pitches.push(midi); // Keep for backward compatibility
                sampleCount.textContent = `${pitchSamples.length} samples (${Math.round(result.confidence * 100)}% conf)`;
            }

            animationId = requestAnimationFrame(detectLoop);
        }

        function stopRecording() {
            isRecording = false;

            if (timerInterval) clearInterval(timerInterval);
            if (animationId) cancelAnimationFrame(animationId);
            if (stream) stream.getTracks().forEach(track => track.stop());
            if (audioContext) audioContext.close();

            recordSection.style.display = 'none';
            analyzing.style.display = 'block';

            setTimeout(analyzeVoice, 500);
        }

        function analyzeVoice() {
            if (pitchSamples.length < 20) {
                analyzing.style.display = 'none';
                recordSection.style.display = 'block';
                instructions.style.display = 'block';
                status.style.display = 'none';
                timer.style.display = 'none';
                recordBtn.className = 'record-btn ready';
                recordBtn.textContent = 'üé§';
                btnHint.textContent = 'Tap to start';
                bars.forEach(bar => bar.style.height = '4px');
                showError('Not enough vocal data. Sing louder and longer ‚Äî we need at least 5 seconds of actual singing, not just breathing into the mic! üé§');
                return;
            }

            const metrics = calculateAdvancedMetrics(pitchSamples);
            
            if (!metrics) {
                analyzing.style.display = 'none';
                recordSection.style.display = 'block';
                instructions.style.display = 'block';
                status.style.display = 'none';
                timer.style.display = 'none';
                recordBtn.className = 'record-btn ready';
                recordBtn.textContent = 'üé§';
                btnHint.textContent = 'Tap to start';
                bars.forEach(bar => bar.style.height = '4px');
                showError('Could not analyze your voice clearly. Try singing more sustained notes (less talking, more "ahhh"). Move closer to the mic!');
                return;
            }

            // Score songs using comfort zone for better matches
            const scored = SONG_DATABASE.map(song => {
                const songRange = song.maxNote - song.minNote;
                
                // Primary: how well does the song fit in their COMFORTABLE range
                const comfortOverlap = Math.min(metrics.comfortHigh, song.maxNote) - Math.max(metrics.comfortLow, song.minNote);
                const comfortFit = Math.max(0, comfortOverlap / songRange);
                
                // Secondary: can they technically hit all the notes?
                const fullOverlap = Math.min(metrics.maxMidi, song.maxNote) - Math.max(metrics.minMidi, song.minNote);
                const fullFit = Math.max(0, fullOverlap / songRange);
                
                // Penalties for notes outside their range
                const exceedsLow = Math.max(0, song.minNote - metrics.minMidi);
                const exceedsHigh = Math.max(0, song.maxNote - metrics.maxMidi);
                const rangePenalty = (exceedsLow + exceedsHigh) * 3;
                
                // Difficulty adjustment based on stability
                let difficultyBonus = 0;
                if (metrics.stability < 40 && song.difficulty === 'easy') difficultyBonus = 25;
                else if (metrics.stability > 70 && song.difficulty === 'hard') difficultyBonus = 10;
                else if (metrics.stability < 60 && song.difficulty === 'hard') difficultyBonus = -20;
                
                // Consistency bonus - if they're consistent, they can handle trickier songs
                const consistencyBonus = metrics.consistency > 70 ? 10 : 0;
                
                const score = (comfortFit * 70) + (fullFit * 30) - rangePenalty + difficultyBonus + consistencyBonus;
                
                return { ...song, score };
            }).sort((a, b) => b.score - a.score);

            const perfect = scored.filter(s => s.score > 65).slice(0, 5);
            const good = scored.filter(s => s.score > 35 && s.score <= 65).slice(0, 4);
            const stretch = scored.filter(s => s.difficulty === 'hard' && s.score > 20).slice(0, 3);
            const crowd = SONG_DATABASE.filter(s => s.difficulty === 'easy')
                .sort(() => Math.random() - 0.5).slice(0, 3);

            // Generate personality-filled feedback
            const feedback = generateFeedback(metrics);

            showResults({
                metrics,
                minNote: midiToNoteName(Math.round(metrics.minMidi)),
                maxNote: midiToNoteName(Math.round(metrics.maxMidi)),
                comfortLow: midiToNoteName(Math.round(metrics.comfortLow)),
                comfortHigh: midiToNoteName(Math.round(metrics.comfortHigh)),
                perfect: perfect.length > 0 ? perfect : scored.slice(0, 5),
                good,
                stretch,
                crowd,
                feedback
            });
        }
        
        function generateFeedback(m) {
            const feedback = {
                headline: '',
                assessment: '',
                tips: [],
                secrets: [],
                suckScore: 0,
                suckLabel: '',
                suckDescription: ''
            };
            
            // ========== THE SUCK METER ==========
            // Calculate suck score (1 = doesn't suck, 100 = maximum suckage)
            const qualityScore = (m.stability + m.consistency + m.breathControl) / 3;
            
            // Range penalty: tiny range = more suck
            let rangePenalty = 0;
            if (m.range < 8) rangePenalty = 20;
            else if (m.range < 12) rangePenalty = 10;
            else if (m.range < 15) rangePenalty = 5;
            
            // Base suck is inverse of quality, adjusted for range
            let rawSuck = 100 - qualityScore + rangePenalty;
            
            // Clamp to 1-100
            feedback.suckScore = Math.max(1, Math.min(100, Math.round(rawSuck)));
            
            // Suck tiers with labels and descriptions
            const suckTiers = [
                { max: 5, label: "Doesn't Suck", emoji: "üëë", color: "#4ade80",
                  descriptions: [
                    "Wait, are you a professional? What are you doing here?",
                    "Did you get lost on your way to The Voice auditions?",
                    "Okay, show-off. Save some talent for the rest of us.",
                    "Your shower must have incredible acoustics... or you're actually good."
                  ]},
                { max: 15, label: "Barely Sucks", emoji: "‚≠ê", color: "#a3e635",
                  descriptions: [
                    "Annoyingly good. People will hate you at karaoke (in the jealous way).",
                    "You're the person everyone wants on their team for group songs.",
                    "Genuinely impressive. Did you come here just to flex?",
                    "The 'I don't really sing' person who then destroys everyone."
                  ]},
                { max: 30, label: "Sucks a Little", emoji: "‚ú®", color: "#facc15",
                  descriptions: [
                    "Respectable! You can hold your own. Minor rough edges add character.",
                    "Solidly above average. The audience will clap AND mean it.",
                    "A few wobbly moments, but honestly? Pretty good.",
                    "You're the friend everyone's happy to hear sing."
                  ]},
                { max: 45, label: "Moderately Sucks", emoji: "üé§", color: "#fb923c",
                  descriptions: [
                    "Welcome to the middle of the bell curve. Population: most people.",
                    "You are the definition of 'fine.' Not great, not terrible. Fine.",
                    "Some hits, some misses. Classic karaoke energy.",
                    "Your enthusiasm outpaces your ability. That's not an insult ‚Äî that's karaoke."
                  ]},
                { max: 60, label: "Kinda Sucks", emoji: "üòÖ", color: "#f97316",
                  descriptions: [
                    "Let's call it 'character vocals.' You've got... character.",
                    "Your voice has opinions that differ from the original melody.",
                    "The spirit is willing but the pitch is weak.",
                    "You're not tone deaf ‚Äî you're tone... independent."
                  ]},
                { max: 75, label: "Really Sucks", emoji: "ü´†", color: "#ef4444",
                  descriptions: [
                    "Group songs only. Safety in numbers. Hide among the talented.",
                    "Confidence will need to do a LOT of heavy lifting here.",
                    "The good news: nobody goes to karaoke for vocal excellence.",
                    "Your voice is a journey. Unfortunately, it's taking wrong turns."
                  ]},
                { max: 90, label: "Majorly Sucks", emoji: "üíÄ", color: "#dc2626",
                  descriptions: [
                    "Embrace the chaos. You're not here to impress ‚Äî you're here to PERFORM.",
                    "What you lack in ability, you must make up for in sheer audacity.",
                    "Have you considered... interpretive dance instead?",
                    "Every note is a surprise! Even to you, apparently."
                  ]},
                { max: 100, label: "Legendary Suck", emoji: "üèÜ", color: "#be123c",
                  descriptions: [
                    "So magnificently terrible it wraps around to being iconic.",
                    "You're not bad at karaoke. Karaoke is bad at containing your energy.",
                    "They'll remember you. Not fondly, but they WILL remember.",
                    "Congratulations! You've achieved a level of suck few dare to reach."
                  ]}
            ];
            
            // Find the appropriate tier
            const tier = suckTiers.find(t => feedback.suckScore <= t.max);
            feedback.suckLabel = tier.label;
            feedback.suckEmoji = tier.emoji;
            feedback.suckColor = tier.color;
            feedback.suckDescription = tier.descriptions[Math.floor(Math.random() * tier.descriptions.length)];
            
            // Assessment based on voice type and range
            const rangeComments = {
                tiny: `${m.range} semitones? That's like... less than an octave. We'll find you some talky songs.`,
                small: `${m.range} semitones ‚Äî a cozy little range. Nothing wrong with staying in your lane!`,
                medium: `${m.range} semitones ‚Äî solid range! Most pop songs are yours for the taking.`,
                large: `${m.range} semitones?! You've got pipes! Time for the showstoppers.`,
                huge: `${m.range} semitones ‚Äî okay Mariah, calm down. Let's put that range to work!`
            };
            
            let rangeCategory;
            if (m.range < 8) rangeCategory = 'tiny';
            else if (m.range < 12) rangeCategory = 'small';
            else if (m.range < 18) rangeCategory = 'medium';
            else if (m.range < 24) rangeCategory = 'large';
            else rangeCategory = 'huge';
            
            feedback.assessment = `${m.voiceEmoji} **${m.voiceType}** ¬∑ ${rangeComments[rangeCategory]}`;
            
            // Generate "How to Suck Less" tips based on weaknesses
            if (m.stability < 40) {
                feedback.tips.push("üéØ **Your pitch wanders like a tourist.** Pick songs with simple, repetitive melodies. Talk-singing is your secret weapon ‚Äî think Lou Reed, not Celine Dion.");
                feedback.tips.push("üí° **One note at a time.** Don't think about the next line until you've survived the current one.");
            } else if (m.stability < 60) {
                feedback.tips.push("üéØ **Pitch drifts detected.** You start okay then slowly migrate to a different key. Songs with strong beats help ‚Äî your body keeps time even when your voice goes walkabout.");
            } else if (m.stability < 75) {
                feedback.tips.push("üéØ **Mostly on pitch with occasional adventures.** You're in the 'good enough' zone ‚Äî focus on song selection and showmanship.");
            } else {
                feedback.tips.push("üéØ **Your pitch control doesn't suck!** Seriously, nice work. You can handle melodic songs. Time to add some style.");
            }
            
            if (m.breathControl < 50) {
                feedback.tips.push("üå¨Ô∏è **Running out of air?** Avoid songs with long held notes. Look for songs with natural pauses ‚Äî your lungs will thank you.");
                feedback.secrets.push("Sneak breaths during instrumental breaks. Gasp dramatically between lines ‚Äî call it 'emotional delivery.'");
            }
            
            if (m.consistency < 50) {
                feedback.tips.push("üé™ **You're all over the place** ‚Äî but that's just chaotic energy looking for a home. Channel it into crowd-pleasers where enthusiasm beats precision.");
            } else if (m.consistency < 70) {
                feedback.tips.push("üé™ **Inconsistent but not hopeless.** Some notes land, some don't. Pick songs where the verses are easy and you can phone in the chorus with everyone else.");
            }
            
            if (m.vibratoPresence > 60) {
                feedback.tips.push("„Ä∞Ô∏è **Natural vibrato detected!** Use it on held notes. It makes you sound fancy and hides slight pitch issues. Win-win.");
            } else if (m.vibratoPresence < 20 && m.stability > 50) {
                feedback.secrets.push("No vibrato? A clean, straight tone works for modern pop. Own it like it's a choice.");
            }
            
            // Voice-type specific tips
            const voiceTips = {
                'Bass': "üé∏ **Bass advantage:** Deep voices are RARE at karaoke. You'll stand out just by existing. Johnny Cash energy ‚Äî low, slow, and cool.",
                'Baritone': "üé∑ **Baritone sweet spot:** The most versatile male range! You can fake going up OR down. Classic rock and soul were made for you.",
                'Tenor': "üé∫ **Tenor truth:** High male voices get the fun songs AND the hard songs. Know when to bail on a high note ‚Äî falsetto or just... skip it.",
                'Alto': "üéª **Alto energy:** Rich, warm tones that cut through noise. Amy Winehouse, Adele's lower stuff, and anything indie. Own the smolder.",
                'Mezzo-Soprano': "üéπ **Mezzo magic:** The Goldilocks zone ‚Äî not too high, not too low. Most pop is literally written for your voice. Lucky you.",
                'Soprano': "‚ú® **Soprano warning:** Just because you CAN hit those notes doesn't mean every song needs them. Save the fireworks or blow out early."
            };
            feedback.tips.push(voiceTips[m.voiceType]);
            
            // Fake-it secrets based on suck level
            if (feedback.suckScore > 70) {
                feedback.secrets.push("ü§´ **The Talk-Sing:** When in doubt, speak rhythmically. Bob Dylan, Rex Harrison, and half of punk rock prove this works.");
                feedback.secrets.push("üëØ **Recruit backup:** Physically drag friends to the mic. Their voices cover yours.");
            } else if (feedback.suckScore > 40) {
                feedback.secrets.push("ü§´ **The Talk-Sing:** For trouble notes, just... speak them dramatically. It's 'artistic interpretation.'");
            }
            
            feedback.secrets.push("üé§ **Mic technique:** Eat the mic on quiet parts, pull away on loud parts. Instant dynamics you didn't earn.");
            feedback.secrets.push("üë• **Crowd work:** Point at the audience during the chorus. They'll sing along and cover your sins.");
            
            if (feedback.suckScore > 50) {
                feedback.secrets.push("üç∫ **Liquid courage calibration:** One drink loosens you up. Three drinks and you stop caring about quality. Find your number.");
                feedback.secrets.push("üì± **Screen dedication:** Stare at the lyrics screen like it contains the meaning of life. No one expects eye contact from someone reading.");
            }
            
            if (m.range < 12) {
                feedback.secrets.push("üîë **Key change exploit:** Most karaoke machines adjust key. Down 2-3 semitones can transform impossible into merely difficult.");
            }
            
            feedback.secrets.push("üé≠ **The Golden Rule:** Confidence > Competence. A boring good singer loses to an entertaining bad one. Move around. Commit to the bit.");
            
            return feedback;
        }

        function showResults(data) {
            analyzing.style.display = 'none';
            
            let perfectHtml = data.perfect.map(s => `
                <div class="song-card">
                    <div class="song-info">
                        <div class="title">${s.title}</div>
                        <div class="artist">${s.artist}</div>
                    </div>
                    <span class="difficulty ${s.difficulty}">${s.difficulty}</span>
                </div>
            `).join('');

            let goodHtml = data.good.length > 0 ? data.good.map(s => `
                <div class="song-card">
                    <div class="song-info">
                        <div class="title">${s.title}</div>
                        <div class="artist">${s.artist}</div>
                    </div>
                    <span class="difficulty ${s.difficulty}">${s.difficulty}</span>
                </div>
            `).join('') : '';

            let stretchHtml = data.stretch && data.stretch.length > 0 ? data.stretch.map(s => `
                <div class="song-card">
                    <div class="song-info">
                        <div class="title">${s.title}</div>
                        <div class="artist">${s.artist}</div>
                    </div>
                    <span class="difficulty ${s.difficulty}">${s.difficulty}</span>
                </div>
            `).join('') : '';

            let crowdHtml = data.crowd.map(s => `
                <div class="song-card">
                    <div class="song-info">
                        <div class="title">${s.title}</div>
                        <div class="artist">${s.artist}</div>
                    </div>
                    <span class="difficulty ${s.difficulty || 'easy'}">${s.difficulty || 'easy'}</span>
                </div>
            `).join('');
            
            let tipsHtml = data.feedback.tips.map(tip => `<div class="tip-item">${tip}</div>`).join('');
            let secretsHtml = data.feedback.secrets.slice(0, 5).map(secret => `<div class="secret-item">${secret}</div>`).join('');

            // Calculate meter position (inverted because 1 = best, 100 = worst)
            const meterPosition = data.feedback.suckScore;

            results.innerHTML = `
                <div class="suck-meter-container">
                    <div class="suck-meter-header">
                        <span class="suck-meter-title">THE SUCK METER</span>
                        <span class="suck-meter-emoji">${data.feedback.suckEmoji}</span>
                    </div>
                    <div class="suck-score-display">
                        <span class="suck-score" style="color: ${data.feedback.suckColor}">${data.feedback.suckScore}</span>
                        <span class="suck-max">/ 100</span>
                    </div>
                    <div class="suck-label" style="color: ${data.feedback.suckColor}">${data.feedback.suckLabel}</div>
                    <div class="suck-meter-track">
                        <div class="suck-meter-gradient"></div>
                        <div class="suck-meter-needle" style="left: ${meterPosition}%"></div>
                    </div>
                    <div class="suck-meter-labels">
                        <span>Doesn't Suck</span>
                        <span>Legendary Suck</span>
                    </div>
                    <div class="suck-description">${data.feedback.suckDescription}</div>
                </div>

                <div class="profile">
                    <h2>Voice Profile</h2>
                    <div class="profile-grid">
                        <div class="profile-item">
                            <label>Voice Type</label>
                            <div class="value">${data.metrics.voiceEmoji} ${data.metrics.voiceType}</div>
                        </div>
                        <div class="profile-item">
                            <label>Full Range</label>
                            <div class="value">${data.minNote} ‚Üí ${data.maxNote}</div>
                        </div>
                        <div class="profile-item">
                            <label>Comfort Zone</label>
                            <div class="value">${data.comfortLow} ‚Üí ${data.comfortHigh}</div>
                        </div>
                        <div class="profile-item">
                            <label>Range Span</label>
                            <div class="value">${data.metrics.range} semitones</div>
                        </div>
                    </div>
                    
                    <div class="metrics-bars">
                        <div class="metric-bar">
                            <div class="metric-label">
                                <span>Pitch Stability</span>
                                <span>${data.metrics.stability}%</span>
                            </div>
                            <div class="metric-track">
                                <div class="metric-fill stability" style="width: ${data.metrics.stability}%"></div>
                            </div>
                        </div>
                        <div class="metric-bar">
                            <div class="metric-label">
                                <span>Consistency</span>
                                <span>${data.metrics.consistency}%</span>
                            </div>
                            <div class="metric-track">
                                <div class="metric-fill consistency" style="width: ${data.metrics.consistency}%"></div>
                            </div>
                        </div>
                        <div class="metric-bar">
                            <div class="metric-label">
                                <span>Breath Control</span>
                                <span>${data.metrics.breathControl}%</span>
                            </div>
                            <div class="metric-track">
                                <div class="metric-fill breath" style="width: ${data.metrics.breathControl}%"></div>
                            </div>
                        </div>
                        ${data.metrics.vibratoPresence > 30 ? `
                        <div class="metric-bar">
                            <div class="metric-label">
                                <span>Vibrato</span>
                                <span>${data.metrics.vibratoPresence}%</span>
                            </div>
                            <div class="metric-track">
                                <div class="metric-fill vibrato" style="width: ${data.metrics.vibratoPresence}%"></div>
                            </div>
                        </div>
                        ` : ''}
                    </div>
                    
                    <div class="assessment">${data.feedback.assessment}</div>
                </div>
                
                <div class="feedback-section tips">
                    <h3>üìâ How To Suck Less</h3>
                    ${tipsHtml}
                </div>

                <div class="song-section perfect">
                    <h3>üéØ Perfect Matches</h3>
                    <p class="section-subtitle">These songs fit your comfortable range like a glove</p>
                    ${perfectHtml}
                </div>

                ${goodHtml ? `
                <div class="song-section good">
                    <h3>üëç Also Great</h3>
                    <p class="section-subtitle">Might need to reach a bit, but totally doable</p>
                    ${goodHtml}
                </div>
                ` : ''}
                
                ${stretchHtml ? `
                <div class="song-section stretch">
                    <h3>üî• Challenge Mode</h3>
                    <p class="section-subtitle">Feeling bold? These will test you</p>
                    ${stretchHtml}
                </div>
                ` : ''}

                <div class="song-section crowd">
                    <h3>üçª Crowd Pleasers</h3>
                    <p class="section-subtitle">When in doubt, these never fail</p>
                    ${crowdHtml}
                </div>
                
                <div class="feedback-section secrets">
                    <h3>ü§´ Cheat Codes</h3>
                    <p class="section-subtitle">Between us... here's how to fake it</p>
                    ${secretsHtml}
                </div>

                <button class="reset-btn" onclick="resetApp()">üîÑ Analyze Again</button>
            `;

            results.className = 'results show';
        }

        function resetApp() {
            pitches = [];
            pitchSamples = [];
            recordingTime = 0;
            isRecording = false;
            
            results.className = 'results';
            results.innerHTML = '';
            recordSection.style.display = 'block';
            instructions.style.display = 'block';
            status.style.display = 'none';
            timer.style.display = 'none';
            errorContainer.innerHTML = '';
            
            recordBtn.className = 'record-btn ready';
            recordBtn.textContent = 'üé§';
            btnHint.textContent = 'Tap to start';
            
            bars.forEach(bar => bar.style.height = '4px');
        }

        // Event listener
        recordBtn.addEventListener('click', () => {
            if (isRecording) {
                stopRecording();
            } else {
                startRecording();
            }
        });
    </script>
</body>
</html>